# Copyright (c) 2026 Petar Djukic. All rights reserved.
# SPDX-License-Identifier: MIT

id: architecture-sdd-hello-world
title: SDD Hello World Architecture

overview:
  summary: |
    SDD Hello World is a minimal Go command-line application and cobbler-scaffold
    test fixture. It consists of one Go source file that prints "Hello, World!" and
    exits with code 0, wrapped in the SDD project structure. The magefiles directory
    holds the scaffolded orchestrator targets that cobbler-scaffold exercises during
    its end-to-end tests.

  lifecycle: |
    The project has two lifecycle phases. Phase 1 established the initial Go binary
    and documentation. Phase 2 integrated the cobbler-scaffold orchestrator via
    mage scaffold:push, producing configuration.yaml and magefiles/orchestrator.go.
    The project is tagged and published as a Go module so PrepareTestRepo can
    download it via the Go module proxy.

  coordination_pattern: |
    There is no runtime coordination. The binary is a single-shot process: it writes
    to stdout and exits. The Mage targets delegate to the cobbler-scaffold orchestrator
    library, which manages measure-stitch cycles and generator lifecycle operations
    against this project when invoked during cobbler-scaffold end-to-end tests.

interfaces:
  - name: Binary CLI
    summary: |
      The compiled binary accepts no flags or arguments. It writes "Hello, World!\n"
      to stdout and exits with code 0.
    data_structures: []
    operations:
      - "main(): write 'Hello, World!' to stdout and exit 0"

  - name: Mage Targets
    summary: |
      The magefiles/orchestrator.go file exposes orchestrator methods as Mage targets.
      These targets are invoked by cobbler-scaffold's end-to-end tests.
    data_structures:
      - "Orchestrator: instantiated from configuration.yaml via NewFromFile()"
    operations:
      - "Build(): compile the sdd-hello-world binary"
      - "Cobbler:Measure(): propose tasks via the orchestrator measure phase"
      - "Cobbler:Stitch(): execute tasks via the orchestrator stitch phase"
      - "Scaffold:Push(): scaffold orchestrator into this project"
      - "Generator:Start/Run/Stop(): generation lifecycle"
      - "Analyze(): cross-artifact consistency checking"
      - "Tag(): create a versioned doc-release tag"

components:
  - name: Binary
    responsibility: |
      Single-file Go program. Writes "Hello, World!\n" to stdout and exits 0.
      Zero external dependencies. The file also defines a Version constant
      populated at generation time via cmd/sdd-hello-world/version.go.
    capabilities:
      - Print "Hello, World!" to stdout
      - Exit with code 0
    references: []

  - name: Magefiles
    responsibility: |
      Scaffolded orchestrator targets. magefiles/orchestrator.go instantiates
      the cobbler-scaffold Orchestrator from configuration.yaml and exposes its
      methods as Mage build targets. This file is generated by mage scaffold:push
      and updated by cobbler-scaffold's E2E test suite via PrepareTestRepo.
    capabilities:
      - Expose orchestrator lifecycle, cobbler, scaffold, analyze, and tag targets
      - Load configuration from configuration.yaml via NewFromFile()
    references: []

design_decisions:
  - id: 1
    title: Zero-dependency binary
    decision: |
      The binary uses only the Go standard library. No external packages are added
      to go.mod beyond the go directive itself.
    benefits:
      - Eliminates dependency churn that could affect cobbler-scaffold test stability
      - Keeps the module minimal and fast to download via the Go module proxy
    alternatives_rejected:
      - "Adding helper packages: unnecessary complexity for a test fixture"

  - id: 2
    title: SDD project structure without specs
    decision: |
      We include VISION.yaml, ARCHITECTURE.yaml, and road-map.yaml but no PRDs,
      use cases, or test suites. The cobbler-scaffold measure phase needs a valid
      vision document to read; the absence of PRDs is intentional â€” this project
      exists only to validate scaffold and measure plumbing, not to drive code generation.
    benefits:
      - Cobbler-scaffold UC003/UC004 tests can exercise the full measure cycle
        against a valid project context without being coupled to real specification work
    alternatives_rejected:
      - "Adding a PRD: would couple test stability to ongoing specification changes"

technology_choices:
  - component: Language
    technology: Go
    purpose: Single-file binary with standard library only
  - component: Build system
    technology: Magefile (magefile/mage)
    purpose: Scaffolded orchestrator targets; invoked by cobbler-scaffold E2E tests
  - component: Module registry
    technology: Go module proxy (proxy.golang.org)
    purpose: PrepareTestRepo downloads this module at a tagged version for E2E tests

project_structure:
  - path: cmd/sdd-hello-world/main.go
    role: Binary entry point; prints Hello, World! and exits 0
  - path: cmd/sdd-hello-world/version.go
    role: Version constant (seed file, populated at generation time)
  - path: magefiles/orchestrator.go
    role: Scaffolded Mage targets delegating to cobbler-scaffold Orchestrator
  - path: magefiles/go.mod
    role: Magefiles module, depends on cobbler-scaffold
  - path: configuration.yaml
    role: Orchestrator configuration (module path, binary name, prompt paths)
  - path: docs/
    role: Project documentation and constitutions
  - path: go.mod
    role: Go module definition (no external dependencies)

implementation_status:
  current_focus: Stable test fixture; no active development
  progress:
    - done: Go binary (cmd/sdd-hello-world/main.go)
    - done: Scaffolded mage targets (magefiles/orchestrator.go)
    - done: Configuration (configuration.yaml)
    - done: Documentation (VISION.yaml, ARCHITECTURE.yaml, road-map.yaml, constitutions)
    - done: Tagged and published as Go module

related_documents:
  - doc: docs/VISION.yaml
    purpose: Project purpose, scope, and success criteria
  - doc: docs/road-map.yaml
    purpose: Release schedule and phase status
  - doc: configuration.yaml
    purpose: Orchestrator configuration
